## template: github.com/zero-os/0-templates/vm/0.0.1

### Description:
This template is responsible for managing a vm on a zero-os node.

### Schema:

- `memory`: amount of memory in MiB. Defaults to 128.
- `cpu`: number of virtual CPUs. Defaults to 1.
- `nics`: list of type Nic specifying the nics of this vm.
- `disks`: list of Disk that can be attached to the vm 
- `flist`: if specified the vm will boot from this flist and not the vdisk.
- `vnc`: the vnc port the machine is listening to.
- `ports`: List of Port.
- `tags`: List of vm tags. e.g ['tag']
- `configs`: List of type Config.
- `ztIdentity`: VM zerotier id. This is generated by the sal if not supplied.
- `ipxeUrl`: ipxe url to create the vm from. Use this to create a zeroos vm.

Nic:
- `id`: vxlan or vlan id
- `type`: NicType enum specifying the nic type
- `hwaddr`: nic's macaddress
- `name`: nic name
- `ztClient`: zerotier client instance name to use to authorize.

NicType enum: 
- `default` 
- `vlan`
- `vxlan`
- `bridge`

Disk:
- `name`: name of the disk
- `url`: media location
- `mountPoint`: path where this disk should be mounted
- `filesystem`: filesystem of the disk

Config:
- `path`: the file path 
- `content`: the file content

Port:
- `name`: name for this portforward
- `source`: node source port
- `destination`: container destination port

### Actions:
- `install`: creates a a vm and the hypervisor on the node.
- `uninstall`: destroys and deletes the service from 0-robot and the node.
- `shutdown`: shuts down the vm.
- `pause`: pause the vm.
- `resume`: resume the vm.
- `reboot`: reboot the vm.
- `reset`: reset the vm.
- `enable_vnc`: if a vnc port is specified, it opens the port.
- `disable_vnc`: if a vnc port is specified, it drops the port.

### Examples:
#### DSL (api interface):
```python
data = {
    'memory': 256,
    'cpu': 1,
    'nics': [{'type':'default'}],
    'flist': 'https://hub.gig.tech/gig-bootable/ubuntu-xenial-bootable-sshd.flist',
    'ports':{'source': 22, 'target': 22, 'name': 'ssh'},
    'configs': [{'path': '/root/.ssh/authorized_keys', 'content': 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDC8tBgGU1', 'name': 'sshkey'}]
}
vm = robot.services.create('github.com/zero-os/0-templates/vm/0.0.1','vm1', data)
vm.schedule_action('install')
```

#### Blueprint (cli interface):
```yaml
services:
    - github.com/zero-os/0-templates/vm/0.0.1__vm1:
        flist: 'https://hub.gig.tech/gig-bootable/ubuntu-xenial-bootable-sshd.flist',
        memory: 256
        cpu: 1
        nics: 
            - type: 'default'
        ports:
            - '22:22'
       configs:
         - path: '/root/.ssh/authorized_keys'
           content: 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDC8tBgGU1'



actions:
    - actions: ['install']
      service: vm1
```
